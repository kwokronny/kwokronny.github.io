<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><title>读记《图解HTTP》 认证、追加协议和攻击手段 KwokRonny&#39;Blog</title><meta name="keywords" content="blog,博客"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><link rel="alternate" href="/atom.xml" title="KwokRonny Feed" type="application/atom+xml"><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?ee452beed5ca135deb3d5befca38907d";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y5BQMHE7WN"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-Y5BQMHE7WN")</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2236624_69rc9okdrcb.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/css/index.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="header"><div class="nav-btn"><span class="lt"><i></i></span><span class="lb"><i></i></span></div><a href="/" class="logo">KwokRonny&#39;Blog</a><div class="nav"><div class="nav-item"><a class="hover" href="/archives"><i class="fa fa-archive"></i> 文章</a></div><div class="nav-item"><a href="/categories" class="hover"><i class="fa fa-inbox"></i> 分类</a><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4/"><i class="fa fa-folder-open"></i> 服务运维</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E8%BF%90%E7%BB%B4/docker/"><i class="fa fa-folder-open"></i> docker</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E6%96%87/"><i class="fa fa-folder-open"></i> 杂文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"><i class="fa fa-folder-open"></i> 解决方案</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/WEB%E5%BC%80%E5%8F%91/"><i class="fa fa-folder-open"></i> WEB开发</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/"><i class="fa fa-folder-open"></i> 软件分享</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"><i class="fa fa-folder-open"></i> 阅读笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/%E6%8A%80%E6%9C%AF%E7%B1%BB/"><i class="fa fa-folder-open"></i> 技术类</a></li></ul></li></ul></div><div class="nav-item"><a href="/tags" class="hover"><i class="fa fa-tag"></i> 标签</a><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag"><i class="fa fa-tag"></i> JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue/" rel="tag"><i class="fa fa-tag"></i> Vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag"><i class="fa fa-tag"></i> css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag"><i class="fa fa-tag"></i> docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/" rel="tag"><i class="fa fa-tag"></i> nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/stylus/" rel="tag"><i class="fa fa-tag"></i> stylus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag"><i class="fa fa-tag"></i> web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag"><i class="fa fa-tag"></i> 工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%9D%E8%B7%AF/" rel="tag"><i class="fa fa-tag"></i> 思路</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1/" rel="tag"><i class="fa fa-tag"></i> 服务</a></li></ul></div><div class="nav-item"><a href="/friend" class="hover"><i class="fa fa-mars"></i> 伙伴们</a><div class="friend-link-list clearfix"><a class="friend" target="_blank" href="https://www.mokeyjay.com/"><img src="https://www.mokeyjay.com/headimg.png"><div class="info"><h3 class="text-clamp_1" title="超能小紫 mokeyjay">超能小紫 mokeyjay</h3><div class="text-clamp_1" title="Web全沾 // 专业学渣 // 贰刺猿 // 永远还不完信用卡">Web全沾 // 专业学渣 // 贰刺猿 // 永远还不完信用卡</div></div></a></div></div><div class="nav-item-link"><a href="/about" class="hover"><i class="fa fa-user"></i></a> <a target="_blank" rel="noopener" href="https://github.com/kwokronny" class="hover"><i class="fa fa-github-alt"></i></a> <a href="/atom.xml" class="hover"><i class="fa fa-rss-square"></i></a></div></div></div><div class="warning-zone"></div><div class="warning-zone right"></div><div class="container-mask"></div><div class="bg-canvas"><div class="loading"><img src="/img/loading.svg"><div>3D Model Loading</div></div><div class="switch-action"><label class="hvr-push"><input type="checkbox" name="rotate"> <i class="iconfont icon-rotate3d"></i></label> <label class="hvr-push"><input type="radio" value="walk" name="action"> <i class="iconfont icon-walk"></i></label> <label class="hvr-push"><input type="radio" value="idle" checked="checked" name="action"> <i class="iconfont icon-idle"></i></label> <label class="hvr-push"><input type="radio" value="push_up" name="action"> <i class="iconfont icon-push_up"></i></label></div></div><div class="main-container"><div id="content-outer"><div id="content-inner"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@10.4.0/styles/dracula.min.css"><div class="left-panel"><div class="article-menu panel"><h3>目录</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-text">用户身份认证</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BASIC-%E8%AE%A4%E8%AF%81"><span class="toc-text">BASIC 认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DIGEST-%E8%AE%A4%E8%AF%81"><span class="toc-text">DIGEST 认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSL-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AE%A4%E8%AF%81"><span class="toc-text">SSL 客户端认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E8%AE%A4%E8%AF%81"><span class="toc-text">表单认证</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-HTTP-%E7%9A%84%E5%8A%9F%E8%83%BD%E8%BF%BD%E5%8A%A0%E5%8D%8F%E8%AE%AE"><span class="toc-text">基于 HTTP 的功能追加协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SPDY%EF%BC%9A%E6%B6%88%E9%99%A4-HTTP-%E7%93%B6%E9%A2%88"><span class="toc-text">SPDY：消除 HTTP 瓶颈</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AJAX"><span class="toc-text">AJAX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Comet"><span class="toc-text">Comet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%8A%9F%E8%83%BD"><span class="toc-text">设计与功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebSocket"><span class="toc-text">WebSocket</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebSocket-%E9%80%9A%E4%BF%A1%E6%AD%A5%E9%AA%A4"><span class="toc-text">WebSocket 通信步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%A1%E6%89%8B%E8%AF%B7%E6%B1%82"><span class="toc-text">握手请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%A1%E6%89%8B%E5%93%8D%E5%BA%94"><span class="toc-text">握手响应</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%9F%E5%BE%85-HTTP-2-0"><span class="toc-text">期待 HTTP&#x2F;2.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-2-0-7%E9%A1%B9%E6%8A%80%E6%9C%AF%E4%B8%8E%E8%AE%A8%E8%AE%BA"><span class="toc-text">HTTP&#x2F;2.0 7项技术与讨论</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%92%88%E5%AF%B9-Web-%E7%9A%84%E6%94%BB%E5%87%BB%E6%8A%80%E6%9C%AF"><span class="toc-text">针对 Web 的攻击技术</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E8%BE%93%E5%87%BA%E5%80%BC%E8%BD%AC%E4%B9%89%E4%B8%8D%E5%AE%8C%E5%85%A8%E5%BC%95%E5%8F%91"><span class="toc-text">因输出值转义不完全引发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%88%96%E8%AE%BE%E8%AE%A1%E7%9A%84%E7%BC%BA%E9%99%B7%E5%BC%95%E5%8F%91"><span class="toc-text">设置或设计的缺陷引发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86%E7%96%8F%E5%BF%BD%E5%BC%95%E5%8F%91"><span class="toc-text">因会话管理疏忽引发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E"><span class="toc-text">其它安全漏洞</span></a></li></ol></li></ol></div></div><article id="post"><h1 class="title">读记《图解HTTP》 认证、追加协议和攻击手段</h1><small class="description"><span class="date"><i class="fa fa-calendar"></i> 2021年03月04日</span> <span><i class="fa fa-inbox"></i> <a class="category-link" href="/categories/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/">阅读笔记</a>><a class="category-link" href="/categories/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/%E6%8A%80%E6%9C%AF%E7%B1%BB/">技术类</a> </span><span><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" rel="tag">网络协议</a>, <a class="tag-link" href="/tags/%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" rel="tag">阅读笔记</a></span></small><blockquote class="text-a_c">本站文章除注明转载外，均为原创文章。如需转载请注明出处：<br><a href="https://kwokronny.top/202103/read-book-diagram-http-4/">https://kwokronny.top/202103/read-book-diagram-http-4/</a></blockquote><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/cover.png" class="" width="0" height="0"><h1 id="用户身份认证"><a href="#用户身份认证" class="headerlink" title="用户身份认证"></a>用户身份认证</h1><p>确认通过客户端访问服务器的用户身份</p><ul><li><h2 id="BASIC-认证"><a href="#BASIC-认证" class="headerlink" title="BASIC 认证"></a>BASIC 认证</h2><blockquote><p>由 HTTP/1.0 便定义的认证方式</p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/http_basic_auth.png" class=""></blockquote><p>当访问资源需要认证时服务器端返回 401 状态码告知客户端需要认证后，</p><ol><li>客户端弹出输入框输入用户名与密码；</li><li>将用户名密码以 <code>&#123;username&#125;:&#123;password&#125;</code> 格式 Base64 编码后发送</li><li>认证成功后返回状态码 200</li></ol><blockquote><p>命令行 curl 或直接获取时可以下方链接示例请求，跳过另外输入用户名与密码过程<br><code>http://&#123;username&#125;:&#123;password&#125;@example.com/</code></p></blockquote><p>缺点：由于用户名密码未经过加密传输，而是直接通过 Base64 编码，当网络被劫持获取 HTTP 报文后，可直接通过 Base64 解码获取用户名与密码。</p></li><li><h2 id="DIGEST-认证"><a href="#DIGEST-认证" class="headerlink" title="DIGEST 认证"></a>DIGEST 认证</h2><p>HTTP/1.1 定义的认证方式，弥补 BASIC 认证 存在的弱点。</p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/http_digest_auth.png" class=""><ol><li>当访问资源需要认证时服务器端返回 401 状态码告知客户端需要认证后，并携带认证所需的质询码<code>nonce</code>。<blockquote><p>WWW-Authenticate 内必须含 <code>realm</code>和<code>nonce</code>两个字段</p></blockquote></li><li>通过客户端发送 Authenticate 首部字段，字段内包含 <code>username</code>、<code>realm</code>、<code>nonce</code>、<code>uri</code>和<code>response</code>字段信息。<ul><li>uri 即 Request-URI 值，考虑经过代理转发后值会被修改，因此会事先复制一份副本保存在 uri 内</li><li>response 存放经过 MD5 运算后的密码字符串</li></ul></li></ol><p>缺点：虽然提供了高于 BASIC 认证的安全等级，与防止密码被窃听的保护机制，但不存在防止用户伪装的保护机制。</p></li><li><h2 id="SSL-客户端认证"><a href="#SSL-客户端认证" class="headerlink" title="SSL 客户端认证"></a>SSL 客户端认证</h2><p>通过安装服务器分发的证书并安装后通过 HTTPS 方式将证书信息以 Client Certificate 报文方式发送给服务器认证。</p><ol><li>接收到需要认证资源的请求，服务器会发送 Certificate Request 报文，要求客户端提供客户端证书。</li><li>用户选择将发送的客户端证书后，客户端会把客户端证书信息以 Client Certificate 报文方式发送给服务器。</li><li>服务器验证客户端证书验证通过后方可领取证书内客户端的公开密钥，然后开始 HTTPS 加密通信。</li></ol><blockquote><p>SSL 客户端认证一般采用 表单认证 + SSL 客户端认证 双因素认证使用</p></blockquote><p>缺点：证书需要费用。</p></li><li><h2 id="表单认证"><a href="#表单认证" class="headerlink" title="表单认证"></a>表单认证</h2><p>非 HTTP 协义定义的认证方式；客户端向服务器发送 WEB 表单信息 认证。</p></li></ul><h1 id="基于-HTTP-的功能追加协议"><a href="#基于-HTTP-的功能追加协议" class="headerlink" title="基于 HTTP 的功能追加协议"></a>基于 HTTP 的功能追加协议</h1><ul><li><h2 id="SPDY：消除-HTTP-瓶颈"><a href="#SPDY：消除-HTTP-瓶颈" class="headerlink" title="SPDY：消除 HTTP 瓶颈"></a>SPDY：消除 HTTP 瓶颈</h2><p>由 Google 开发，用于解决 HTTP 的性能瓶颈。</p><blockquote><p>如 Facebook 和 Twitter 等 SNS 网站上，可以实时观察海量用户公开发布的内容，当几百、几千万的用户发布内容时，在很短的时间内会发生大量的内容更新。<br>以下 HTTP 协议标准成为了瓶颈</p></blockquote><ul><li>一条连接上只可发送一个请求</li><li>请求只能从客户端开始。客户端不可接收除响应以外的指令</li><li>请求/响应首部未经压缩就发送</li><li>发送冗长的首部，且每次互相发送相同的首部造成的浪费较多</li><li>可任意选择数据压缩格式，非强制性</li></ul><h3 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h3><p>AJAX(Asynchronous JavaScript and XML) 利用 JS 和 DOM 操作，完成对局部 Web 页面 替换加载的异步通信手段。由于只更新局部页面，响应的数据量传输就可以大大减少。</p><p>AJAX 核心技术是通过 XMLHTTPRequest 的 API，通过 JavaScript 完成与服务器的 HTTP 通信。</p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/http_ajax.png" class="" width="600"><h3 id="Comet"><a href="#Comet" class="headerlink" title="Comet"></a>Comet</h3><p>通过服务器接收到请求会在处理完毕后立即返回响应，但为了实现推送功能，会先将响应挂起，当服务器有了内容更新后再返回响应。为了保留响应，一次连接的持续时间也变长了，使的消耗更多的资源。</p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/http_comet.png" class="" width="600"><h3 id="设计与功能"><a href="#设计与功能" class="headerlink" title="设计与功能"></a>设计与功能</h3><p>SPDY 没有完全改写 HTTP 协议，SPDY 以会话层的形式加入，控制对数据的流动，但还是采用 HTTP 建立通信连接。</p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/spdy.png" class="" width="200"><p>SPDY 赋予了 HTTP 协议以下功能</p><ul><li><p><strong>多路复用流</strong><br>通过一次的 TCP 连接打开页面后，可以通过 AJAX 无限制的处理多次 HTTP 请求。</p></li><li><p><strong>赋予请求优先级</strong><br>可以通过 JS 按顺序 AJAX 请求，解决因宽带低导致响应变的问题</p></li><li><p><strong>压缩 HTTP 首部</strong><br>压缩了 HTTP 首部，减少了通信消耗</p></li><li><p><strong>推送功能</strong><br>服务器可直接发送数据，而不必等待客户端的请求</p></li><li><p><strong>服务器提示功能</strong><br>由于在客户端发现资源之前就可以获知资源的存在，因此在资源已缓存等情况下，可以避免发送不必要的请求。</p></li></ul></li><li><h2 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h2><p>建立在 HTTP 协议 基础上，因此连接的发起方仍是客户端。一旦确立了 WebSocket 的通信连接，不论服务器还是客户端，任意一方都可直接向对方发送报文。</p><p><strong>主要特点</strong></p><ul><li>推送功能</li><li>减少通信量</li></ul><h2 id="WebSocket-通信步骤"><a href="#WebSocket-通信步骤" class="headerlink" title="WebSocket 通信步骤"></a>WebSocket 通信步骤</h2><ul><li><h3 id="握手请求"><a href="#握手请求" class="headerlink" title="握手请求"></a>握手请求</h3>应用 HTTP 首部字段 <code>Upgrade</code> 更新为 websocket 协议<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">GET &#x2F;chat HTTP&#x2F;1.1<br>Host: socket.example.com<br>Upgrade: websocket<br>Connection: Upgrade<br>Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ&#x3D;&#x3D;<br>Origin:http:&#x2F;&#x2F;example.com<br>Sec-WebSocket-Protocol:chat,superchat<br>Sec-WebSocket-Version:13<br></code></pre></td></tr></table></figure><code>Sec-WebSocket-Key</code> 记录着握手的必需主键<br><code>Sec-WebSocket-Protocol</code> 定义连接的名称 “,”分隔</li><li><h3 id="握手响应"><a href="#握手响应" class="headerlink" title="握手响应"></a>握手响应</h3>返回状态码 101 Switching Protocols 的响应。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">HTTP&#x2F;1.1 101 Switching Protocols<br>Upgrade: websocket<br>Connection: Upgrade<br>Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo&#x3D;<br>Sec-WebSocket-Protocol: chat<br></code></pre></td></tr></table></figure><code>Sec-WebSocket-Accept</code> 的字段值是由握手请求中的 <code>Sec-WebSocket-Key</code> 的字段值生成的。</li></ul><p>成功确认连接后，通信时不再使用 HTTP 的数据帧，而采用 WebSocket 独立数据帧</p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/websocket.png" class="" width="600"></li><li><h2 id="期待-HTTP-2-0"><a href="#期待-HTTP-2-0" class="headerlink" title="期待 HTTP/2.0"></a>期待 HTTP/2.0</h2><p>HTTP Speed + Mobility 由微软公司起草，建立在 Google 公司提出的 SPDY 与 WebSocket 的基础上。<br>Netword-Friendly HTTP Upgrade 主要是在移动端通信时改善 HTTP 性能</p><h3 id="HTTP-2-0-7项技术与讨论"><a href="#HTTP-2-0-7项技术与讨论" class="headerlink" title="HTTP/2.0 7项技术与讨论"></a>HTTP/2.0 7项技术与讨论</h3><table><thead><tr><th align="left">技术</th><th align="left">采用协议</th></tr></thead><tbody><tr><td align="left">压缩</td><td align="left">SPDY、Friendly</td></tr><tr><td align="left">TLS 义务化</td><td align="left">SPDY</td></tr><tr><td align="left">协商</td><td align="left">Speed+Mobility</td></tr><tr><td align="left">客户端拉取/服务端推送</td><td align="left">Speed+Mobility、Friendly</td></tr><tr><td align="left">流量控制</td><td align="left">SPDY</td></tr><tr><td align="left">WebSocket</td><td align="left">Speed+Mobility</td></tr></tbody></table></li></ul><h1 id="针对-Web-的攻击技术"><a href="#针对-Web-的攻击技术" class="headerlink" title="针对 Web 的攻击技术"></a>针对 Web 的攻击技术</h1><blockquote><p>HTTP 的设计初衷本就是更好的分享知识，是一种通用单纯协议机制；因此不具备必要的安全性功能。</p></blockquote><ul><li><h2 id="因输出值转义不完全引发"><a href="#因输出值转义不完全引发" class="headerlink" title="因输出值转义不完全引发"></a>因输出值转义不完全引发</h2><p>通过URL查询字段，表单提交，HTTP首部字段提交含有攻击命令的代码，Web应用未对用户提交的数据进行转义处理，相应的攻击语句则会入侵了数据库或系统。<br>客户端 JS 对用户提交数据的进行转义处理对Web应用的攻击起不到保护作用。客户端校验主要是起到UI体验的作用。</p><ul><li><p><strong>XSS 跨站脚本攻击</strong><br>利用未对用户输入进行转义处理的表单，提交非法 HTML 标签或 JavaScript 脚本。网站动态生成并执行了未转义的攻击代码，通过攻击代码获取用户cookie等会话，将信息提交至攻击者网站等。</p></li><li><p><strong>SQL注入攻击</strong><br>通过攻击者输入的查询文本，Web应用未转义并直接拼接至SQL语句中，返回攻击者想要窃取的信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 正常的Sql语句</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> bookTbl <span class="hljs-keyword">WHERE</span> author <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;上野宣&#x27;</span> <span class="hljs-keyword">and</span> flag <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br><span class="hljs-comment">-- 攻击者传入的语句: `--`之后全是注释了，缺少了flag=1的条件</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> bookTbl <span class="hljs-keyword">WHERE</span> author <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;上野宣&#x27;</span><span class="hljs-comment">--&#x27; and flag = 1</span><br></code></pre></td></tr></table></figure></li><li><p><strong>OS命令注入攻击</strong><br>通过Web应用，执行非法的操作系统命令达到攻击的目的。只要在能调用Shell函数的地方就有存在被攻击的风险。</p></li><li><p><strong>HTTP首部注入攻击</strong><br>攻击者通过在响应截断，在响应返回首部字段内插入换行，添加任意响应首部，如重定向至攻击者网站透导用户填入个人信息。</p></li><li><p><strong>目录遍历攻击</strong><br>对本无意公开的文件目录，通过非法截断其目录路径后，达成访问目的的一种攻击。这种攻击有时也称为路径遍历（Path Traversal）攻击。</p></li><li><p><strong>远程文件包含漏洞</strong><br>当部分脚本内容需要从其他文件读入时，攻击者利用指定外部服务器的URL充当依赖文件，让脚本读取之后，就可运行任意脚本的一种攻击。（这主要是PHP存在的安全漏洞，对PHP的include或require来说，这是一种可通过设定，指定外部服务器的URL作为文件名的功能。）</p></li></ul></li><li><h2 id="设置或设计的缺陷引发"><a href="#设置或设计的缺陷引发" class="headerlink" title="设置或设计的缺陷引发"></a>设置或设计的缺陷引发</h2><ul><li><p><strong>强制游览</strong><br>主要是指未对不应公开的 备份文件 或 配置文件 设置拒绝访问，导致配置信息泄漏等安全问题。</p></li><li><p><strong>不正确的错误消息处理</strong><br>指 Web应用 将 应用错误消息、数据库等系统错误消息 未处理直接抛出，使得攻击者获得下一步的攻击情况，实施更致命的攻击。</p></li><li><p><strong>开放重定向</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">http:&#x2F;&#x2F;example.com&#x2F;?rediect&#x3D;http:&#x2F;&#x2F;hacker.site<br></code></pre></td></tr></table></figure><p>由Web应用支持开放自定义重定向功能，用户通过URL链接以为是访问 <code>example.com</code> 的网址，实际被诱导跳转至攻击者的 <code>http://hacker.site</code> 网站</p></li></ul></li><li><h2 id="因会话管理疏忽引发"><a href="#因会话管理疏忽引发" class="headerlink" title="因会话管理疏忽引发"></a>因会话管理疏忽引发</h2><ul><li><p><strong>会话劫持</strong><br>攻击者通过非正规生成方法推测会话Cookie/ID、窃听或XSS攻击和会话固定攻击获取会话Cookie/ID。<br>使用窃取的会话Cookie/ID对应的用户身份访问网站；实施非法行为。</p></li><li><p><strong>会话固定攻击</strong></p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/attack_session.jpg" class=""><p>攻击者可私自创建会员ID构成陷阱，诱导用户使用该会话ID进行认证后激活攻击者创建的会话ID，攻击者就可以通过该会话ID进行访问</p><blockquote><p>Session Adoption 主指 PHP 或 ASP.NET 能够接收处理未知会话ID的功能。</p></blockquote></li><li><p><strong>跨站点请求伪造（CSRF)</strong></p><img src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/202103/read-book-diagram-http-4/attack_csrf.jpg" class=""><p>攻击者通过设置好的陷阱，强制对已完成认证的用户进行非预期的个人信息或设定信息等某些状态更新。<br>如：攻击者通过 因未完成转义处理 为用户设下脚本陷阱，当用户触发陷阱时，并且用户已登陆认证时，将触发用户不知情的攻击行为。</p></li></ul></li></ul><ul><li><h2 id="其它安全漏洞"><a href="#其它安全漏洞" class="headerlink" title="其它安全漏洞"></a>其它安全漏洞</h2><ul><li><p><strong>密码破解</strong><br>这里就不多说了，通过对 Web应用 进行暴力破解，或通过社会工程学收集到的用户信息生成可能的密码字典尝试出真实密码。<br>所以 Web应用 需要对认证窗口增验证码及最大尝试次数限制，防止此攻击</p></li><li><p><strong>点击劫持</strong><br>通过透明的按钮或链接做成陷阱，误导用户不知情下点击进入陷阱。</p></li><li><p><strong>DoS攻击</strong><br>最无解的一种攻击方式，通过海量的请求导致服务器呈现停止状态，或通过攻击安全漏洞使服务停止。攻击通过扫描嗅探网络中有安全漏洞的服务器（肉鸡），利用多台肉鸡攻击目标服务器。<br>常见的防御方式是动态CDN和增加服务器带宽。</p></li><li><p><strong>后门程序</strong><br>开发设置的隐藏入口，可不按正常方式使用受限功能。</p><ul><li>开发阶段作为 Debug 调用的后门程序</li><li>开发者为了自身利益植入后门程序</li><li>攻击者通过某种方法设置后门程序</li></ul></li></ul></li></ul><div class="donate-panel"><label><input type="checkbox"><i class="fa fa-qrcode"></i> 打赏</label> 如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作!<div class="donate-code"><img src="/img/wechat_pay.jpg"> <img src="/img/alipay.jpg"></div></div><script type="text/javascript">document.querySelector(".donate-panel input").addEventListener("change",function(){document.querySelector(".donate-code").classList.toggle("show")})</script><script id="KBComment" src="https://kwokronny.top/kb-comment/client.js" token="6db58d39e6603fe32a8eecfffaf37d05" theme="dark" crossorigin="anonymous" async></script></article></div></div></div><div class="footer">Power by <a target="_blank" rel="noopener" href="http://hexo.io">hexo</a>. | 3D Model Thx SketchFab: <a target="_blank" rel="noopener" href="https://sketchfab.com/Blender3D">Blender3D</a>, <a target="_blank" rel="noopener" href="https://sketchfab.com/arexon">Arexon</a></div><script src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/js/three/three.min.js"></script><script src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/js/three/GLTFLoader.min.js"></script><script src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/js/three/OrbitControls.min.js"></script><script src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/js/index.js"></script><script src="https://cdn.jsdelivr.net/gh/kwokronny/kwokronny.github.io@latest/js/minecraft.js"></script></body></html>