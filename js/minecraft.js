!function(){var i,a,o,s,r,E,d,c,p,l,w,t=!1,n=0;function u(){requestAnimationFrame(u);var e=d.getDelta();E.update(e),TWEEN.update(),r[0].offset.x-=.007,r[1].offset.x+=.007,t&&(n+=.004,c.rotation.y=n%360),a.render(i,o)}function g(){var e=s.getBoundingClientRect().width,t=s.getBoundingClientRect().height;o.aspect=e/t,window.innerWidth<=750?(o.position.set(0,3,10),c.position.y=1,p.position.y=1):(o.position.set(0,2,16),p.position.y=-2,c.position.y=-2,c.rotation.x=0),o.updateProjectionMatrix(),a.setSize(e,t)}!function(){var e=(s=document.querySelector(".bg-canvas")).getBoundingClientRect().width,t=s.getBoundingClientRect().height;(o=new THREE.PerspectiveCamera(45,e/t,1,2e3)).position.set(0,2,16),d=new THREE.Clock,i=new THREE.Scene;var n=new THREE.HemisphereLight(15921906,15921906);n.position.set(0,50,0),i.add(n),(n=new THREE.DirectionalLight(16777215)).position.set(0,30,0),n.castShadow=!0,n.shadow.camera.near=.1,n.shadow.camera.far=60,i.add(n),(c=new THREE.Object3D).position.y=-4,i.add(c),(p=new THREE.Object3D).position.y=-4,i.add(p),(n=(new THREE.TextureLoader).load("/gltf/textures/grass.png")).wrapS=n.wrapT=THREE.RepeatWrapping,n.repeat.set(5,5),n.anisotropy=16,n.encoding=THREE.sRGBEncoding,(n=new THREE.Mesh(new THREE.CylinderBufferGeometry(5,5,.1,32),new THREE.MeshLambertMaterial({map:n}))).receiveShadow=!0,c.add(n),(r=[(new THREE.TextureLoader).load("/img/warning_zone.png"),(new THREE.TextureLoader).load("/img/warning_zone.png")]).forEach(function(e){e.wrapS=THREE.RepeatWrapping,e.repeat.set(5,1)}),(w=[])[0]=new THREE.Mesh(new THREE.PlaneGeometry(21.2,.6),new THREE.MeshBasicMaterial({map:r[0]})),w[0].receiveShadow=!0,w[0].position.set(-25,3,-5.4),w[0].rotation.set(0,.2,-.15),new TWEEN.Tween(w[0].position).to({x:2,y:3,z:-5.4},1500).easing(TWEEN.Easing.Cubic.Out).start(),w[1]=new THREE.Mesh(new THREE.PlaneGeometry(848/60,.4),new THREE.MeshBasicMaterial({map:r[1]})),w[1].receiveShadow=!0,w[1].position.set(25,1.5,5.4),w[1].rotation.set(0,-.3,.15),new TWEEN.Tween(w[1].position).to({x:-2,y:1.5,z:5.4},1500).easing(TWEEN.Easing.Cubic.Out).start(),w.forEach(function(e){p.add(e)}),(n=new THREE.GLTFLoader).load("/gltf/pumpkin.gltf",function(e){e=e.scene;e.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,e.castShadow=!0)}),e.rotation.set(0,1,0),e.position.set(1,.1,-2.4);e.scale.set(.33,.33,.33),c.add(e)}),n.load("/gltf/zombie.gltf",function(e){var t=e.scene;t.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,e.castShadow=!0)}),t.position.set(.6,0,2.5),t.scale.set(1.5,1.5,1.5),c.add(t),E=new THREE.AnimationMixer(t),(l={push_up:E.clipAction(e.animations[0]),idle:E.clipAction(e.animations[1]),walk:E.clipAction(e.animations[2])}).walk.play(),u();e=s.querySelector(".loading");s.removeChild(e)}),(a=new THREE.WebGLRenderer({alpha:!0,antialias:!0})).setPixelRatio(window.devicePixelRatio),a.setSize(e,t),a.outputEncoding=THREE.sRGBEncoding,a.shadowMap.enabled=!0,a.shadowMap.type=THREE.PCFSoftShadowMap,s.appendChild(a.domElement),g(),window.addEventListener("resize",g,!1)}(),document.querySelectorAll(".bg-canvas .switch-action input").forEach(function(e){e.addEventListener("change",function(e){"checkbox"==e.target.type?t=!t:(Object.values(l).forEach(function(e){e.stop()}),e=e.target.value,l[e].play())})})}();