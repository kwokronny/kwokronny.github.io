var scene,renderer,camera,stats,controls,container,mixer,clock,stage,actions;function init(){var e=(container=document.querySelector(".bg-canvas")).getBoundingClientRect().width,n=container.getBoundingClientRect().height;(camera=new THREE.PerspectiveCamera(45,e/n,1,2e3)).position.set(0,2,16),clock=new THREE.Clock,scene=new THREE.Scene;const t=new THREE.HemisphereLight(15921906,15921906);t.position.set(0,50,0),scene.add(t),(stage=new THREE.Object3D).position.y=-4,scene.add(stage);const a=new THREE.DirectionalLight(16777215);a.position.set(0,30,0),a.castShadow=!0,a.shadow.camera.near=.1,a.shadow.camera.far=60,scene.add(a);const o=(new THREE.TextureLoader).load("/gltf/textures/grass.png");o.wrapS=o.wrapT=THREE.RepeatWrapping,o.repeat.set(4,4),o.anisotropy=16,o.encoding=THREE.sRGBEncoding;var i=new THREE.Mesh(new THREE.CylinderBufferGeometry(5,5,.1,32),new THREE.MeshLambertMaterial({map:o}));i.receiveShadow=!0,stage.add(i);i=new THREE.GLTFLoader;i.load("/gltf/pumpkin.gltf",function(e){e=e.scene;e.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,e.castShadow=!0)}),e.rotation.set(0,1,0),e.position.set(1,.1,-2.4);e.scale.set(.33,.33,.33),stage.add(e)}),i.load("/gltf/zombie.gltf",function(e){var n=e.scene;n.traverse(function(e){e.isMesh&&(e.frustumCulled=!1,e.castShadow=!0)}),n.position.set(.6,0,2.5),n.scale.set(1.5,1.5,1.5),stage.add(n),mixer=new THREE.AnimationMixer(n),(actions={}).push_up=mixer.clipAction(e.animations[0]),actions.idle=mixer.clipAction(e.animations[1]),actions.walk=mixer.clipAction(e.animations[2]),actions.idle.play(),animate();e=container.querySelector(".loading");container.removeChild(e)}),(renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0})).setPixelRatio(window.devicePixelRatio),renderer.setSize(e,n),renderer.outputEncoding=THREE.sRGBEncoding,renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,(controls=new THREE.OrbitControls(camera,renderer.domElement)).enableDamping=!0,controls.autoRotate=!1,controls.enableZoom=!1,controls.minPolarAngle=Math.PI/2,controls.maxPolarAngle=Math.PI/2,container.appendChild(renderer.domElement),onWindowResize(),window.addEventListener("resize",onWindowResize,!1)}function animate(){requestAnimationFrame(animate);var e=clock.getDelta();mixer.update(e),controls.update(),render()}function onWindowResize(){var e=container.getBoundingClientRect().width,n=container.getBoundingClientRect().height;camera.aspect=e/n,window.innerWidth<=750?(controls.enabled=!1,camera.position.set(0,3,11),stage.position.y=-2):(controls.enabled=!0,camera.position.set(0,2,16),stage.position.y=-4,stage.rotation.x=0),camera.updateProjectionMatrix(),renderer.setSize(e,n)}function render(){renderer.render(scene,camera)}init(),document.querySelectorAll(".bg-canvas .switch-action input").forEach(function(e){e.addEventListener("change",function(e){"checkbox"==e.target.type?(controls.autoRotate=!controls.autoRotate,controls.update()):(Object.values(actions).forEach(function(e){e.stop()}),e=e.target.value,actions[e].play())})});